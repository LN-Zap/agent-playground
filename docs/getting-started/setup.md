# Setup

## Prerequisites

- [Nix](https://nixos.org/download.html): Declarative package manager for reproducible environments.
- [devenv.sh](https://devenv.sh/): Developer environment manager.
- [direnv](https://direnv.net/): Shell extension to automatically load the environment.

## Installation

1. Clone the repository:

   ```bash
   git clone https://github.com/LN-Zap/agent-playground.git
   cd agent-playground
   ```

2. Install dependencies:

   ```bash
   npm install
   ```

   This installs dependencies, generates all agent configuration files via `rulesync generate`, and installs git hooks for ongoing synchronization.

3. *(Optional)* Enable automatic environment loading with `direnv`:

   ```bash
   direnv allow
   ```

   devenv provides additional auto-regeneration when source files change. See `devenv.nix`.

## Dev Containers

This repository supports [Dev Containers](https://containers.dev/) via `.devcontainer.json`, generated by [devenv](https://devenv.sh/integrations/codespaces-devcontainer/). Use with VS Code or GitHub Codespaces for a preconfigured environment.

## Environment Variables

Add the following variables to your `.env` file:

| Variable                   | Description                                 | Documentation |
|----------------------------|---------------------------------------------|---------------|
| `GEMINI_API_KEY`           | API key for Gemini access                   | [Get key](https://aistudio.google.com/api-keys) |
| `GITHUB_TOKEN`             | GitHub token for fetching private skill repositories | [Create token](https://github.com/settings/tokens) |
| `CLOUDFLARE_API_TOKEN`     | Cloudflare API token for Workers/Observability | [API Tokens](https://dash.cloudflare.com/profile/api-tokens) |
| `CLOUDFLARE_ACCOUNT_ID`    | Cloudflare Account ID                       | [Find Account ID](https://developers.cloudflare.com/fundamentals/setup/find-account-and-zone-ids/) |
| `PAGERDUTY_USER_API_KEY`   | PagerDuty User API key                      | [Create API Key](https://support.pagerduty.com/docs/generating-api-keys) |

See `.env.example` for a documented template.

!!! note "Authentication"
    Fetching skills from private repositories requires a `GITHUB_TOKEN` environment variable. In Codespaces this is provided automatically. For local development, add it to `.env` (loaded by devenv via `dotenv.enable`).

    **Recommended scopes**:
    
    - **Fine-grained PAT (recommended)**: Grant repository access to the skill source repositories and set **Contents: Read-only** and **Metadata: Read-only**.
    - **Classic PAT**: Use the `repo` scope (minimum practical scope for private repository read access).
